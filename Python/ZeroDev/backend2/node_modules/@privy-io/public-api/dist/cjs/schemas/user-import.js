"use strict";var e=require("zod"),t=require("./core.js"),s=require("./embedded-wallet-creation.js"),o=require("./user.js");require("bs58"),require("libphonenumber-js/max"),require("viem"),require("./wallet-api/wallets/index.js"),require("@privy-io/api-base"),require("./api.js"),require("./transaction.js"),require("./wallet-api/export.js"),require("./wallet-api/wallets/spark/index.js"),require("./wallet-api/wallets/spark/utils.js"),require("./smart-wallet-config.js"),require("../constants/smart-wallets.js");const a=e.z.object({type:e.z.literal("wallet"),address:e.z.union([t.WalletAddress,t.SolanaWalletAddress]),chain_type:e.z.enum(["ethereum","solana"])}),r=e.z.object({type:e.z.literal("email"),address:t.Email}),n=e.z.object({type:e.z.literal("phone"),number:t.PhoneNumber}),c=e.z.object({type:e.z.literal("google_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),email:t.Email,name:e.z.string()}).strict(),u=e.z.object({type:e.z.literal("twitter_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),name:e.z.string().min(1).max(50),username:e.z.string().regex(/^[0-9a-zA-Z|\_]{1,15}$/),profile_picture_url:e.z.string().url().refine((e=>e.startsWith("https://abs.twimg.com/sticky/default_profile_images/")||e.startsWith("https://pbs.twimg.com/profile_images/"))).optional()}).strict(),i=e.z.object({type:e.z.literal("discord_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),username:e.z.string().regex(/^(?!discord|everyone|here)[0-9a-zA-Z_.]{2,32}(?:#(?:[0-9]{4}|0))?$/).transform((e=>e.includes("#")?e:`${e}#0`)),email:t.Email.optional()}).strict(),l=e.z.object({type:e.z.literal("spotify_oauth"),subject:e.z.string(),name:e.z.string().optional(),email:t.Email.optional()}).strict(),m=e.z.object({type:e.z.literal("github_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),username:e.z.string().regex(/^[a-zA-Z0-9]+(?:-[a-zA-Z0-9]+)*$/).max(39),name:e.z.string().optional(),email:t.Email.optional()}).strict(),p=e.z.object({type:e.z.literal("instagram_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),username:e.z.string().regex(/^(?!instagram|everyone|here)[0-9a-zA-Z._]{2,32}$/)}).strict(),d=e.z.object({type:e.z.literal("tiktok_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),username:e.z.string().regex(/^(?!tiktok|everyone|here)[0-9a-zA-Z]{2,32}$/),name:e.z.string().min(1).max(30).nullable()}).strict(),h=e.z.object({type:e.z.literal("line_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),email:t.Email.optional(),name:e.z.string().min(1).max(30).optional(),profile_picture_url:e.z.string().url().refine((e=>e.startsWith("https://")),{message:"Profile picture URL must start with https://"}).optional()}).strict(),g=e.z.object({type:e.z.literal("linkedin_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),name:e.z.string().optional(),email:t.Email.optional(),vanityName:e.z.string().optional()}).strict(),_=e.z.object({type:e.z.literal("apple_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),email:t.Email.optional()}).strict(),z=e.z.object({type:e.z.literal("farcaster"),fid:e.z.number().int(),owner_address:t.WalletAddress,username:e.z.string().max(256).optional(),display_name:e.z.string().max(32).optional(),bio:e.z.string().max(256).optional(),profile_picture_url:e.z.string().max(256).optional(),homepage_url:e.z.string().max(256).optional()}).strict(),A=e.z.object({type:e.z.literal("telegram"),telegram_user_id:e.z.string().min(1).max(255),first_name:e.z.string().max(255).optional(),last_name:e.z.string().max(255).optional(),username:e.z.string().max(255).optional(),photo_url:e.z.string().max(255).optional()}).strict(),b=e.z.object({type:e.z.literal("custom_auth"),custom_user_id:e.z.string().min(1).max(256)}).strict(),I=e.z.discriminatedUnion("type",[a,r,n,c,u,i,m,l,p,d,h,_,g,z,A,b]);let x=I.array().min(1).transform((e=>{let t={emailAccounts:[],phoneAccounts:[],ethereumAccounts:[],solanaAccounts:[],googleAccounts:[],twitterAccounts:[],discordAccounts:[],githubAccounts:[],spotifyAccounts:[],instagramAccounts:[],tiktokAccounts:[],lineAccounts:[],linkedinAccounts:[],appleAccounts:[],farcasterAccounts:[],telegramAccounts:[],customJwtAccounts:[]};for(let s of e)switch(s.type){case"wallet":"ethereum"===s.chain_type&&t.ethereumAccounts.push(s),"solana"===s.chain_type&&t.solanaAccounts.push(s);break;case"email":t.emailAccounts.push(s);break;case"phone":t.phoneAccounts.push(s);break;case"google_oauth":t.googleAccounts.push(s);break;case"twitter_oauth":t.twitterAccounts.push(s);break;case"discord_oauth":t.discordAccounts.push(s);break;case"github_oauth":t.githubAccounts.push(s);break;case"spotify_oauth":t.spotifyAccounts.push(s);break;case"instagram_oauth":t.instagramAccounts.push(s);break;case"tiktok_oauth":t.tiktokAccounts.push(s);break;case"line_oauth":t.lineAccounts.push(s);break;case"linkedin_oauth":t.linkedinAccounts.push(s);break;case"apple_oauth":t.appleAccounts.push(s);break;case"farcaster":t.farcasterAccounts.push(s);break;case"telegram":t.telegramAccounts.push(s);break;case"custom_auth":t.customJwtAccounts.push(s)}return t})).superRefine(((t,s)=>{t.emailAccounts&&t.emailAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one email account."}),t.phoneAccounts&&t.phoneAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one phone number account."}),t.googleAccounts&&t.googleAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Google account."}),t.linkedinAccounts&&t.linkedinAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one LinkedIn account."}),t.twitterAccounts&&t.twitterAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Twitter account."}),t.discordAccounts&&t.discordAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Discord account."}),t.githubAccounts&&t.githubAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one GitHub account."}),t.tiktokAccounts&&t.tiktokAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Tiktok account."}),t.lineAccounts&&t.lineAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Line account."}),t.spotifyAccounts&&t.spotifyAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Spotify account."}),t.instagramAccounts&&t.instagramAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Instagram account."}),t.appleAccounts&&t.appleAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Apple account."}),t.farcasterAccounts&&t.farcasterAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Farcaster account."}),t.telegramAccounts&&t.telegramAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Telegram account."}),t.customJwtAccounts&&t.customJwtAccounts.length>0&&t.customJwtAccounts.length>1&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one custom JWT account."})}));const w=e.z.object({create_embedded_wallet:e.z.boolean().optional(),create_n_embedded_wallets:e.z.number().min(1).max(10).optional(),create_n_ethereum_wallets:e.z.number().min(1).max(10).optional(),create_ethereum_wallet:e.z.boolean().optional(),create_solana_wallet:e.z.boolean().optional(),create_ethereum_smart_wallet:e.z.boolean().optional()}).strict(),k=s.EmbeddedWalletCreationInput.merge(w),j=k.extend({linked_accounts:x,custom_metadata:o.CustomMetadata.optional()}).superRefine(((t,s)=>{void 0!==t.create_embedded_wallet&&void 0!==t.create_n_ethereum_wallets&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"create_embedded_wallet is deprecated, use create_ethereum_wallet instead"}),void 0!==t.create_ethereum_wallet&&void 0!==t.create_n_embedded_wallets&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"create_n_embedded_wallets is deprecated, use create_n_ethereum_wallets instead"}),t.create_ethereum_smart_wallet&&!t.create_ethereum_wallet&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"create_ethereum_smart_wallet requires create_ethereum_wallet to be true"})})),f=e.z.object({users:j.array().max(20)}),y=e.z.object({create_ethereum_wallet:e.z.boolean().optional(),number_of_ethereum_wallets_to_create:e.z.number().min(1).max(10).optional(),create_ethereum_smart_wallet:e.z.boolean().optional(),create_solana_wallet:e.z.boolean().optional()}).strict();let C=(t,s)=>{t.create_ethereum_smart_wallet&&!t.create_ethereum_wallet&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"create_ethereum_smart_wallet requires create_ethereum_wallet to be true"}),!t.create_ethereum_wallet&&t.number_of_ethereum_wallets_to_create&&s.addIssue({code:e.z.ZodIssueCode.custom,message:"create_ethereum_wallet must be true if number_of_ethereum_wallets_to_create is specified"})},v=s.EmbeddedWalletCreationInput.merge(y);const Z=v.extend({user_id:t.UserId}).superRefine(C),U=v.superRefine(C);exports.CreateEmbeddedWalletUserImportInput=w,exports.CreateWalletInput=y,exports.EmbeddedWalletCreationInputUnion=k,exports.ImportAppleAccountInput=_,exports.ImportCustomJwtAccountInput=b,exports.ImportDiscordAccountInput=i,exports.ImportEmailAccountInput=r,exports.ImportFarcasterAccountInput=z,exports.ImportGithubAccountInput=m,exports.ImportGoogleAccountInput=c,exports.ImportInstagramAccountInput=p,exports.ImportLineAccountInput=h,exports.ImportLinkedInAccountInput=g,exports.ImportManyUsersInput=f,exports.ImportPhoneAccountInput=n,exports.ImportSpotifyAccountInput=l,exports.ImportTelegramAccountInput=A,exports.ImportTiktokAccountInput=d,exports.ImportTwitterAccountInput=u,exports.ImportUserInput=j,exports.ImportWalletAccountInput=a,exports.LinkedAccountInput=I,exports.WalletCreateUserInput=Z,exports.WalletCreateUserInputWithoutUserId=U;
