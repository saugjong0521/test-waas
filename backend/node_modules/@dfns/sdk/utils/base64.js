"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.fromBase64Url = exports.toBase64Url = exports.fromBase64 = exports.toBase64 = void 0;
const buffer_1 = require("buffer");
const pad = (topad) => {
    const padLength = 4 - (topad.length % 4);
    if (padLength < 4) {
        topad += '='.repeat(padLength);
    }
    return topad;
};
const toBase64 = (buffer) => {
    if (typeof buffer === 'string') {
        buffer = buffer_1.Buffer.from(buffer);
    }
    return buffer.toString('base64');
};
exports.toBase64 = toBase64;
const fromBase64 = (encoded) => {
    return buffer_1.Buffer.from(pad(encoded), 'base64');
};
exports.fromBase64 = fromBase64;
const toBase64Url = (buffer) => {
    return (0, exports.toBase64)(buffer).replace(/=/g, '').replace(/\+/g, '-').replace(/\//g, '_');
};
exports.toBase64Url = toBase64Url;
const fromBase64Url = (encoded) => {
    encoded = pad(encoded).replace(/\-/g, '+').replace(/_/g, '/');
    return buffer_1.Buffer.from(encoded, 'base64');
};
exports.fromBase64Url = fromBase64Url;
